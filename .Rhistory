as.numeric('NULL')
eval('NULL')
test=1:463
r=c(2,20,40)
which(test %in% r)
column=rep(1,length(test))
column[!which(test %in% r)]=0
which(column==0)
column
test %in% r
column[which(!(test %in% r))]=0
source("robustness function library.R")
obj=read.table('objectives_all463.txt') # load data for calculating robustness
View(obj)
colnames(obj)[-c(1,2)])
colnames(obj)[-c(1,2)]
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
unlist(lapply(str_split(5, ','), as.integer))
unlist(lapply(str_split(c(10,40,50), ','), as.integer))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
colnames(add_to_tradeoff)
# this includes the non dominated front. Calculated externally to save app loading time
metrics_4app=readRDS('tradeoff_dataframes.rds')
## scale mean_variance between 0 and 1
colID=which(!(colnames(metrics_4app[['mean.variance']]) %in% c('policy', 'front')))
for(i in colID){ # start in column three to skip ID and front
max=max(metrics_4app$mean.variance[,i])
replace=metrics_4app$mean.variance[,i]/max
metrics_4app$mean.variance[,i]=replace
}
# used for x axis in stacked histogram plot
metrics.list=readRDS('Robustness_metrics_463solns_List.rds')
metrics.list[['baseline']]=metrics_4app$baseline
################### import data for stacked histogram plotting ##########################
bar_plot_data=readRDS(file='data for stacked bar plot.rds')
long_data=bar_plot_data$long_data
wide_data=bar_plot_data$wide_data
wide_data$policy=1:nrow(wide_data)
add_to_tradeoff_all=wide_data[4:8] # T1e, T1V, maxVol, nTiers to add to each df for filtering
add_to_tradeoff=dplyr::filter(add_to_tradeoff_all, policy %in% metrics.list$satisficing$policy)[-ncol(add_to_tradeoff_all)]# minus five to remove policy
colnames(add_to_tradeoff)
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# Robustness calculations for 463 solutions tested in 500 member SOW ensemble
# Phase III robustness calcs
# Nathan Bonham
# 2/16/21
## Libaries
library(dplyr)
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts') # directory to robustness function library.R
source('robustness function library.R')
############# import objectives
# the processing of objective .rdf files is handled in readRDF scenario folders.R
setwd("G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/data")
obj=read.table('objectives_all463.txt')
## unit conversion for objectives. I want all LB shortage volumes in KAF and Powell WY Release in MAF
vol_index=which(colnames(obj)%in% c('LB.Shortage.Volume', 'LB.Shortage.Volume.Policy','Max.Annual.LB.Shortage'))
obj[vol_index]=obj[vol_index]/1000
obj$Powell.WY.Release=obj$Powell.WY.Release/1e6
MOEA_archive=read.table('Mead Solutions/Archive_463solns.txt') # data from MOEA optimization. From Rebecca
MOEA_data=MOEA_archive[,15:22] # subset only the objectives (remove decision levers)
names=c('Mead.1000', 'LB.Max.Cons.Shortage.Duration', 'LB.Shortage.Frequency',
'LB.Shortage.Volume', 'Max.Annual.LB.Shortage', 'Powell.3490', 'Powell.WY.Release', 'Lee.Ferry.Deficit') # I double checked the names with the spreadsheet Rebecca gave me
# the spreadsheet lives here: G:\My Drive\CU Boulder\Phase 3 Robustness Calculations\R\data\Mead Solutions\from Rebecca\Archive_Master_withID.xlsx
colnames(MOEA_data)=names
## unit conversion for MOEA_data
vol_index2=which(colnames(MOEA_data)%in% c('LB.Shortage.Volume', 'LB.Shortage.Volume.Policy','Max.Annual.LB.Shortage'))
MOEA_data[vol_index2]=MOEA_data[vol_index2]/1000
MOEA_data$Powell.WY.Release=MOEA_data$Powell.WY.Release/1e6
## define different subsets of objectives, including if they are minimized or maximized
## From the Borg Archive, LB.Shortage.Volume.Policy is NOT included. Further, from my robusntess analysis it is redundant with  LBSV, so will not include from here on
# allObj=colnames(obj)[-c(1,2)] # includes LB.Shortage.Volume and LB.Shortage.Volume.Policy
# all_best_if= c('min','min','min','min','min','min','min','min','min')
obj8=colnames(obj)[-c(1,2,4)] # excludes LB.Shortage.Volume.Policy, keeps LB.Shortage.Volume
obj8_best_if=c('min','min','min','min','min','min','min','min')
## select objectives to use in the robustness metrics
obj_vec=obj8
best_if=obj8_best_if
metrics.list=list() # preallocate a list to store calculations
############################## Satisficing #########
satisficing.Mead.1000=satisficing(data=obj, objectives='Mead.1000', thresholds = 10)
satisficing.Powell.3490=satisficing(objectives='Powell.3490', thresholds = 5)
satisficing.LBSV=satisficing(objectives='LB.Shortage.Volume', thresholds=600)
View(satisficing.LBSV)
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0", launch.browser=TRUE))
# V5 is what you presented to Reclamation on 3/17/21
setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies V5/CRB-Robustness-App-BOR')
#what you are developing for Journal article
# setwd('G:/My Drive/CU Boulder/Phase 3 Robustness Calculations/R/scripts/Interactive dashboards/Robustness App All policies for Journal Article/Robustness-App-4Journal')
filename='Par Coords and Stacked Histograms.Rmd'
# saves a .html file that you can share. Struggling to get all pages to render
# rmarkdown::render('filename')
#make errors print in r console
# options(shiny.error=browser)
# render to your Viewer. From viewer, can publish to a server like shinyapps.io or open in browser
rmarkdown::run(filename, shiny_args = list(port = 3838, host = "0.0.0.0"))
